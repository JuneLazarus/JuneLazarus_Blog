<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="bk_colour.css">
    <title>JuneLazarus | 用户登录</title>
    <script src="https://cdn.staticfile.net/vue/3.0.5/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/polyfill@7.12.1/dist/polyfill.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <style>
#gxcwel{
    width:28rem;
    height:auto;
    margin-left: 15%;
    margin-top: 50px;
    border-radius: 50%;
    object-fit: cover;
    z-index: -2;
    opacity: 0.75;
    transition: 150ms ease;
}
#gxcwel:hover{
    opacity: 1;
    border-radius: 50px;
    transform: scale(1.1);
    transition: 150ms ease;
}
.boxes{
    display: flex;
    overflow: hidden;
    width: 90rem;
    height: 60rem;
    background-color:rgba(255,255,255,60%) ;
    border-radius: 1.5rem;
    margin: 3% auto;
    box-shadow: 0 0 1rem 0.2rem rgb(0,0,0,10%);
}
.left{
    position: relative;
    width: 45%;
    height: 100%;
    background-color: skyblue;
    opacity: 0.6;
}
.left::before{
    content: "";
    position: absolute;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background-image:url(gxc1.jpg);
    background-size:auto 100%;
    margin-left: 0;
    opacity: 0.9;
}
.right{
    display: flex;
    width:55%;
    height:100%;
    flex-direction: column;
    align-items: center;
}
.form-container {
    display: flex;
    flex-direction: column;
    justify-content: center;
    flex-grow: 1;
    width: 100%;
}
.right h4{
    color:rgba(26, 79, 255,0.9);
    font-size: 3rem;
    margin-top: 2.5rem;
}
.right form{
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
}
.form-group {
    width: 100%;
    margin-bottom: 0.75rem;
    position: relative;
}
.right form{
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
}
.right form .acc{
    outline: none;
    width: 80%;
    height: 4rem;
    font-size: 1.3rem;
    margin-top: 0.8rem;
    margin-left: 4.6rem;
    padding: 1rem 0 0 1.2rem;
    border:none;
    border-bottom: 1px solid rgb(29, 13, 255);
    color:rgb(0,0,0);
    background-color: rgba(0,0,0,0);   
    justify-content: center;
    align-items: center;
}
.right form .acc:focus{
    outline: none;
    color:rgb(0,0,0);
    padding:1rem 0 0 1.6rem;
}
.right form .acc-contact-input{
    outline: none;
    width: 80%;
    height: 4rem;
    font-size: 1.3rem;
    margin-top: 1rem;
    margin-left: 4.6rem;
    padding: 1rem 0 0 1.2rem;
    border:none;
    border-bottom: 1px solid rgb(29, 13, 255);
    color:rgb(0,0,0);
    background-color: rgba(0,0,0,0);   
    justify-content: center;
    align-items: center;
}
.right form .acc-contact-input:focus{
    outline: none;
    color:rgb(0,0,0);
    padding:1rem 0 0 1.6rem;
}
.right form .contact-input{
    outline: none;
    width: 80%;
    height: 4rem;
    font-size: 1.3rem;
    margin-top: 0.8rem;
    margin-left: 4.6rem;
    padding: 1rem 0 0 1.2rem;
    border:none;
    border-bottom: 1px solid rgb(29, 13, 255);
    color:rgb(0,0,0);
    background-color: rgba(0,0,0,0);   
    justify-content: center;
    align-items: center;
}
.right form .contact-input:focus{
    outline: none;
    color:rgb(0,0,0);
    padding:1rem 0 0 1.6rem;
}
.right form .login{
    outline: none;
    width: 80%;
    height: 3rem;
    font-size: 1.5rem;
    margin-top: 5rem;
    margin-left: 4rem;
    padding: 1rem 0 2rem;
    border:none;
    border-bottom: 1px solid rgb(29, 13, 255);
    color:rgb(0,0,0);
    background-color: rgba(0,0,0,0);   
}
.right form .login:focus{
    outline: none;
    color:rgb(0,0,0);
    padding:1rem 0 0 1.6rem;
}
.button-container {
    display: flex;
    justify-content: center;
    width: 100%;
    margin: 20px 0;
}
.right .submit{
    width: 60%;
    height:5rem;
    color:white;
    background-image:linear-gradient(120deg,rgba(44,114,251,1) 0%, rgb(11, 190, 245) 100%);
    font-size:2rem;
    border:none;
    border-radius: 0.5rem;
    margin: 2rem 0 0 50%;
    transform: translateX(-50%);
}
.right .submit::after {
    content: ''; 
    position: absolute;
    top: -5px;
    left: -5px;
    right: -5px;
    bottom: -5px;
    z-index: -1;
    background: linear-gradient(to right, rgba(44,114,251,1), rgb(11, 190, 245));
    background-size: 400%;
    border-radius: 5px;
    opacity: 0;
}
.right .submit:hover::after {
    filter: blur(5px);
    opacity: 0.75;
    animation: animation 12s linear infinite;
}
        .fn {
            display: flex;
            justify-content: center;
            width: 100%;
            margin-top: 1rem;
        }
        .fn a {
            text-decoration: none;
            color: #666;
            font-size: 1.4rem;
            transition: color 0.3s;
        }
        .fn a:hover {
            color: rgb(25, 161, 196);
        }
        #toggle-button {
            border: none;
            background-color: transparent;
            padding: 0;
            font-size: 1.4rem;
            color: #666;
            margin: 15px 0;
            cursor: pointer;
            transition: color 0.3s;
            text-align: center;
            width: 100%;
        }
        #toggle-button:hover {
            color: rgb(25, 161, 196);
        }
.admin-login {
    display: none;
    width: 100%;
}
.error-tip {
    color: red;
    font-size: 1.4rem;
    margin-top: 5px;
    display: none;
    text-align: center;
}
        .user-code-display {
            background-color: #f0f8ff;
            padding: 10px 15px;
            border-radius: 5px;
            margin-top: 0.9rem;
            font-size: 1.4rem;
            display: none;
            text-align: center;
        }
        .mode-tabs {
            display: flex;
            width: 100%;
            margin-bottom: 0.6rem;
            border-bottom: 3px solid #eee 0;
        }
        .mode-tab {
            flex: 1;
            text-align: center;
            padding: 0.6rem;
            cursor: pointer;
            font-size: 1.6rem;
            transition: all 0.3s;
        }
        .mode-tab.active {
            color: rgba(26, 79, 255, 0.9);
            border-bottom: 3px solid rgba(26, 79, 255, 0.9);
        }
        @media (max-width: 900px) {
            .boxes {
                flex-direction: column;
                height: auto;
            }
            .left, .right {
                width: 100%;
            }
            .left {
                min-height: 200px;
            }
            #gxcwel {
                width: 15rem;
            }
        }
        @media (max-width: 600px) {
            .right {
                padding: 20px 15px;
            }
            .right h4 {
                font-size: 2rem;
            }
            .right form input {
                font-size: 1.4rem;
            }
            .right .submit {
                font-size: 1.6rem;
                width: 70%;
            }
        }
    </style>
</head>
<body>
    <div>
        <a href="https://www.bilibili.com/video/BV1GJ411x7h7/?spm_id_from=333.337.search-card.all.click" target="_blank">
            <img src="gxc2.jpg" alt="工小成还在赶来的路上~" id="gxcwel">
        </a>
    </div>
    
    <div class="boxes" id="auth-container">
        <div class="left">
        </div>
        
        <div class="right">
            <div class="mode-tabs">
                <div class="mode-tab active" id="user-tab">用户登录</div>
                <div class="mode-tab" id="admin-tab">管理员登录</div>
            </div>
            
            <div class="form-container">
                <!-- 用户登录表单 -->
                <form action="hall.html" method="GET" id="login-form">
                    <h4 class="log" style="display: flex; justify-content: center; align-items: center;">用户登录</h4>
                    <div class="form-group">
                        <input class="login" type="text" placeholder="用户序列号" id="user-code-input" name="user_code" required>//页面优化中，先点击管理员登录再点回用户登录即恢复正常
                    </div>
                    <div class="form-group">
                        <input class="login" type="password" placeholder="密码" id="password-input" name="password" required>//记得注册账户
                    </div>
                    <div class="error-tip" id="login-error"></div>
                    <div class="button-container">
                        <button class="submit" type="submit">登 录</button>
                    </div>
                </form>
                
                <!-- 用户注册表单 -->
                <form action="hall.html" method="GET" id="register-form" style="display: none;">
                    <h4 class="reg" style="display: flex; justify-content: center; align-items: center;">用户注册</h4>
                    <div class="form-group">
                        <input class="acc-contact-input" type="text" placeholder="用户名" id="username-input" name="username" required>
                    </div>
                    <div class="form-group">
                        <input class="contact-input" type="tel" placeholder="手机号" id="phone-input" name="phone">
                    </div>
                    <div class="form-group">
                        <input class="acc" type="password" placeholder="密码" id="reg-password-input" name="password" required>
                    </div>
                    <div class="form-group">
                        <input class="acc" type="password" placeholder="确认密码" id="confirm-password-input" required>
                    </div>
                    <div class="user-code-display" id="user-code-display"></div>
                    <div class="error-tip" id="register-error"></div>
                    <div class="button-container">
                        <button class="submit" type="submit">注 册</button>
                    </div>
                </form>
                
                <!-- 管理员登录表单 -->
                <form action="admin.html" method="GET" id="admin-login-form" class="admin-login">
                    <h4 class="log" style="display: flex; justify-content: center; align-items: center;">管理员登录</h4>
                    <div class="form-group">
                        <input class="login" type="text" placeholder="管理员序列号" id="admin-code-input" name="admin_code" required>
                    </div>
                    <div class="form-group">
                        <input class="login" type="password" placeholder="密码" id="admin-password-input" name="password" required>
                    </div>
                    <div class="error-tip" id="admin-error"></div>
                    <div class="button-container">
                        <button class="submit" type="submit">管理员登录</button>
                    </div>
                </form>
                
                <div class="fn">
                    <a href="forgotpwd.html">忘记密码</a>
                </div>
                
                <div style="text-align: center;">
                    <button id="toggle-button">还没有账号？去注册</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // reg/log form
        const toggleButton = document.getElementById('toggle-button');
        const loginForm = document.getElementById('login-form');
        const registerForm = document.getElementById('register-form');
        const adminLoginForm = document.getElementById('admin-login-form');
        const userTab = document.getElementById('user-tab');
        const adminTab = document.getElementById('admin-tab');
        
        // swap user/admin
        userTab.addEventListener('click', () => {
            userTab.classList.add('active');
            adminTab.classList.remove('active');
            loginForm.style.display = 'block';
            registerForm.style.display = 'none';
            adminLoginForm.style.display = 'none';
            toggleButton.style.display = 'block';
        });
        
        adminTab.addEventListener('click', () => {
            adminTab.classList.add('active');
            userTab.classList.remove('active');
            loginForm.style.display = 'none';
            registerForm.style.display = 'none';
            adminLoginForm.style.display = 'block';
            toggleButton.style.display = 'none';
        });
        
        // swap reg/log
        toggleButton.addEventListener('click', () => {
            if (loginForm.style.display === 'none') {
                loginForm.style.display = 'block';
                registerForm.style.display = 'none';
                toggleButton.textContent = '还没有账号？去注册';
            } else {
                loginForm.style.display = 'none';
                registerForm.style.display = 'block';
                toggleButton.textContent = '已有帐号？去登录';
            }
        });
        
        // access reg form
        const registerFormEl = document.getElementById('register-form');
        registerFormEl.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username-input').value.trim();
            const phone = document.getElementById('phone-input').value.trim();
            const password = document.getElementById('reg-password-input').value;
            const confirmPassword = document.getElementById('confirm-password-input').value;
            const errorElement = document.getElementById('register-error');
            
            if (!username) {
                alert('用户名不能为空');
                errorElement.style.display = 'block';
                return;
            }
            
            if (!phone) {
                alert('手机号不能为空');
                errorElement.style.display = 'block';
                return;
            }
            
            if (phone) {
                const phoneRegex = /^1[3-9]\d{9}$/;
                if (!phoneRegex.test(phone)) {
                    alert('手机号格式不正确');
                    errorElement.style.display = 'block';
                    return;
                }
            }
            
            if (password.length < 6) {
                alert('密码长度不能少于6位');
                errorElement.style.display = 'block';
                return;
            }
            
            if (password !== confirmPassword) {
                alert('两次输入密码不一致');
                errorElement.style.display = 'block';
                return;
            }
            
            // 生成用户序列号（模拟）
            const userCode = generateUserCode();
            document.getElementById('user-code-display').textContent = `您的用户序列号: ${userCode} (请妥善保存)`;
            document.getElementById('user-code-display').style.display = 'block';
            
            // 保存用户信息到localStorage（模拟数据库）
            const userInfo = {
                user_code: userCode,
                username: username,
                phone: phone,
                password: password
            };
            
            // localStorage
            let users = JSON.parse(localStorage.getItem('users') || '[]');
            users.push(userInfo);
            localStorage.setItem('users', JSON.stringify(users));
            
            // 显示成功信息
            errorElement.style.display = 'none';
            alert('注册成功！您的用户序列号已生成，请使用它登录。');
            alert('界面跳转后将自动填充您的序列号（请务必妥善保存）')
            
            // 自动切换到登录界面
            loginForm.style.display = 'block';
            registerForm.style.display = 'none';
            toggleButton.textContent = '还没有账号？去注册';
            document.getElementById('user-code-input').value = userCode;
        });
        
        // access log form
        const loginFormEl = document.getElementById('login-form');
        loginFormEl.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const userCode = document.getElementById('user-code-input').value.trim();
            const password = document.getElementById('password-input').value;
            const errorElement = document.getElementById('login-error');
            
            if (!userCode || !password) {
                alert('用户序列号和密码不能为空');
                errorElement.style.display = 'block';
                return;
            }
            
            // 从localStorage获取用户数据（模拟数据库查询）
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const user = users.find(u => u.user_code === userCode && u.password === password);
            
            if (!user) {
                alert ('用户序列号或密码错误');
                errorElement.style.display = 'block';
                return;
            }
            
            // 登录成功，保存当前用户信息
            localStorage.setItem('currentUser', JSON.stringify(user));
            errorElement.style.display = 'none';
            
            // 跳转到大厅页面
            alert('登录成功！');
            window.location.href = 'hall.html';
        });
        
        // access admin info
        const adminLoginFormEl = document.getElementById('admin-login-form');
        adminLoginFormEl.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const adminCode = document.getElementById('admin-code-input').value.trim();
            const password = document.getElementById('admin-password-input').value;
            const errorElement = document.getElementById('admin-error');
            
            if (!adminCode || !password) {
                errorElement.textContent = '管理员序列号和密码不能为空';
                errorElement.style.display = 'block';
                return;
            }
            
            // 预设管理员账号（模拟数据库）
            const admins = [
                { admin_code: 'admin_JuneL', password: 'June123456', display_name: 'June' },
                { admin_code: 'admin_Lia', password: 'admin123', display_name: '系统管理员' },
                { admin_code: 'admin_Super', password: 'admin123', display_name: '超级管理员' }
            ];
            
            const admin = admins.find(a => a.admin_code === adminCode && a.password === password);
            
            if (!admin) {
                alert('管理员序列号或密码错误');
                errorElement.style.display = 'block';
                return;
            }
            
            // 登录成功，保存当前管理员信息
            localStorage.setItem('currentAdmin', JSON.stringify(admin));
            errorElement.style.display = 'none';
            
            // 跳转到管理员页面
            alert('管理员登录成功！');
            window.location.href = 'admin.html';
        });
        
        // 生成用户序列号（模拟数据库自增ID）
        function generateUserCode() {
            let users = JSON.parse(localStorage.getItem('users') || '[]');
            const nextId = users.length + 1;
            return `user_id${String(nextId).padStart(3, '0')}`;
        }
        
        // 控制台提示信息
        console.log("页面加载完成");
        console.log("登录验证已添加基本功能");
        console.log("用户数据存储在localStorage中");
    </script>
</body>
</html>